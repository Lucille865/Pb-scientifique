using System;
using System.Collections.Generic;
using System.Drawing;
using System.Windows.Forms;

public class GrapheVisualisation
{
    private Graphe graphe;

    // Le constructeur pour initialiser le graphe et la fenêtre
    public GrapheVisualisation(Graphe graphe)
    {
        this.graphe = graphe;
        this.Text = "Visualisation du Graphe";  // Titre de la fenêtre
        this.Size = new Size(600, 600);  // Taille de la fenêtre
        this.Paint += new PaintEventHandler(DessinerGraphe);  // Méthode pour dessiner le graphe
    }

    // La méthode qui dessine le graphe à l'écran
    private void DessinerGraphe(object sender, PaintEventArgs e)
    {
        // Créer un objet Graphics pour dessiner
        Graphics g = e.Graphics;
        Dictionary<int, Point> positions = new Dictionary<int, Point>();

        // Définir un rayon pour placer les nœuds en cercle
        int rayon = 200;
        int centreX = this.ClientSize.Width / 2;  // Le centre de la fenêtre en X
        int centreY = this.ClientSize.Height / 2;  // Le centre de la fenêtre en Y
        int nbNoeuds = graphe.GetNbNoeuds();  // Nombre de nœuds dans le graphe
        double angleStep = 2 * Math.PI / nbNoeuds;  // L'angle entre chaque nœud pour les disposer en cercle

        // Calculer la position de chaque nœud en cercle
        int index = 0;
        foreach (var noeud in graphe.GetListeAdjacence().Keys)
        {
            int x = centreX + (int)(rayon * Math.Cos(index * angleStep));  // Coordonnée X du nœud
            int y = centreY + (int)(rayon * Math.Sin(index * angleStep));  // Coordonnée Y du nœud
            positions[noeud] = new Point(x, y);  // Sauvegarder la position du nœud dans un dictionnaire
            index++;
        }

        // Dessiner les liens (les arêtes entre les nœuds)
        Pen pen = new Pen(Color.Black, 2);  // Créer un stylo pour dessiner les liens
        foreach (var entry in graphe.GetListeAdjacence())
        {
            int noeud1 = entry.Key;  // Le premier nœud
            foreach (int noeud2 in entry.Value)
            {
                // Dessiner une ligne entre les nœuds
                g.DrawLine(pen, positions[noeud1], positions[noeud2]);
            }
        }

        // Dessiner les nœuds (les cercles représentant les sommets)
        foreach (var entry in positions)
        {
            int x = entry.Value.X;  // Coordonnée X du nœud
            int y = entry.Value.Y;  // Coordonnée Y du nœud

            // Dessiner un cercle pour chaque nœud
            g.FillEllipse(Brushes.Blue, x - 10, y - 10, 20, 20);  // Remplir avec une couleur bleue
            g.DrawString(entry.Key.ToString(), new Font("Arial", 12), Brushes.White, x - 7, y - 7);  // Afficher le numéro du nœud
        }
    }
}
